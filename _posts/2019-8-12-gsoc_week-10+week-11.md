---
title:  "Week 10 + Week 11 (ASR - German)"
date:   2019-8-12
layout: single
author_profile: true
comments: true
tags: [GSoC, ASR]
category: GSoC
toc: true
toc_label: "Contents"
toc_icon: "heart"
---

Link to [Repository of Code](https://github.com/AASHISHAG/asr-german)

### Describe my work briefly

I am happy to update on my Week 10 and Week 11 progress. This period was the most exciting period. I spent time training and evaluatig the model and finally running it on CASE HPC.

### Training

This was the most crucial part. I arranged all the modules namely, MFCC Features, Acoustic Model and Language Model and tested the sequence on a smaller dataset, before putting the model on training on the complete data. The training took around 9 days to complete and finally it was 100%.

``` bash
[steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 5478/5483   Jobs: 1   Epoch: 4.00/4.0 (99.9% complete)   lr: 0.000100   shrink: 0.99799
[steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 5479/5483   Jobs: 1   Epoch: 4.00/4.0 (99.9% complete)   lr: 0.000100   shrink: 0.99800
[steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 5480/5483   Jobs: 1   Epoch: 4.00/4.0 (99.9% complete)   lr: 0.000100   shrink: 0.99800
...
[steps/nnet3/chain/train.py:519 - train - INFO ] Iter: 5483/5483   Jobs: 1   Epoch: 4.00/4.0 (100.0% complete)   lr: 0.000100   shrink: 0.99800
[steps/nnet3/chain/train.py:575 - train - INFO ] Doing final combination to produce final.mdl
```

### Results

Here are some of the results I obtained after training the model. These results are based on _best_wer_ file generated by Kaldi.

**_Word Error Rate_ vs _Training Stages_**
<p align="center"><img src="/others/training_graph.png" width='54%' height='60%'></p>

**Percentage of _Deletion_, _Insertion_ and _Subsitution Error_ across different Training Stages**

<img align = "left" src="/others/error_graph-1.png" width='43%' height='45%'>
<img float ="right" src="/others/error_graph-2.png" width='44%' height='45%'>

``` bash
%WER 58.10 [ 38790 / 66768, 1903 ins, 16466 del, 20421 sub ] [PARTIAL] exp//tri1/decode_dev_nosp/wer_10_0.0
%WER 61.21 [ 42600 / 69600, 1981 ins, 18961 del, 21658 sub ] [PARTIAL] exp//tri1/decode_test_nosp/wer_10_0.0
%WER 57.75 [ 38560 / 66768, 1614 ins, 18899 del, 18047 sub ] [PARTIAL] exp//tri2/decode_dev_nosp/wer_10_0.0
%WER 59.67 [ 41528 / 69600, 2130 ins, 18606 del, 20792 sub ] [PARTIAL] exp//tri2/decode_test_nosp/wer_9_0.0
%WER 28.85 [ 19261 / 66768, 3215 ins, 2902 del, 13144 sub ] [PARTIAL] exp//tri3/decode_dev_nosp/wer_14_0.0
%WER 28.08 [ 18750 / 66768, 3345 ins, 2516 del, 12889 sub ] [PARTIAL] exp//tri3/decode_dev_pron/wer_13_0.5
%WER 29.56 [ 20572 / 69600, 3568 ins, 2894 del, 14110 sub ] [PARTIAL] exp//tri3/decode_test_nosp/wer_13_0.0
%WER 29.14 [ 20279 / 69600, 3557 ins, 2696 del, 14026 sub ] [PARTIAL] exp//tri3/decode_test_pron/wer_13_0.5
%WER 23.44 [ 15653 / 66768, 3164 ins, 1976 del, 10513 sub ] [PARTIAL] exp//tri4_cleaned/decode_dev/wer_14_0.5
%WER 31.36 [ 20941 / 66768, 3578 ins, 2911 del, 14452 sub ] [PARTIAL] exp//tri4_cleaned/decode_dev.si/wer_13_0.5
%WER 24.86 [ 17305 / 69600, 3544 ins, 1996 del, 11765 sub ] [PARTIAL] exp//tri4_cleaned/decode_test/wer_13_0.5
%WER 31.90 [ 22202 / 69600, 3858 ins, 2984 del, 15360 sub ] [PARTIAL] exp//tri4_cleaned/decode_test.si/wer_13_0.5
%WER 24.08 [ 16075 / 66768, 3463 ins, 1819 del, 10793 sub ] [PARTIAL] exp//tri4/decode_dev_pron/wer_14_0.5
%WER 35.20 [ 23504 / 66768, 4244 ins, 3034 del, 16226 sub ] [PARTIAL] exp//tri4/decode_dev_pron.si/wer_14_0.5
%WER 25.50 [ 17745 / 69600, 3879 ins, 1855 del, 12011 sub ] [PARTIAL] exp//tri4/decode_test_pron/wer_13_0.5
%WER 35.44 [ 24668 / 69600, 4759 ins, 2898 del, 17011 sub ] [PARTIAL] exp//tri4/decode_test_pron.si/wer_13_0.5
%WER 14.61 [ 9758 / 66768, 2517 ins, 884 del, 6357 sub ] [PARTIAL] exp//chain_cleaned/tdnn1f_2048_sp_bi/decode_dev/wer_12_1.0
%WER 15.62 [ 10871 / 69600, 2746 ins, 865 del, 7260 sub ] [PARTIAL] exp//chain_cleaned/tdnn1f_2048_sp_bi/decode_test/wer_11_1.0
```

**_Some Audio Clips and Results_**

**[DE_01]**

<audio controls>
  <source src="/others/de_1.wav" type="audio/wav">
</audio>

``` bash
$ Gerrit erinnerte sich daran dass er einst einen Eid geschworen hatte
$ Garrett erinnerte sich daran dass er einst einen Eid geschworen hatte
```

**[DE_02]**

<audio controls>
  <source src="/others/de_2.wav" type="audio/wav">
</audio>

``` bash
$ Wenn man schnell fährt ist man von Emden nach Landshut nicht lange unterwegs
$ Weil man schnell fährt ist man von Emden nach Landshut nicht lange unterwegs
```

**[DE_03]**

<audio controls>
  <source src="/others/de_3.wav" type="audio/wav">
</audio>

``` bash
$ Valentin hat das Handtuch geworfen
$ Valentin hat das Handtuch geworfen
```

**[DE_04]**

<audio controls>
  <source src="/others/de_4.wav" type="audio/wav">
</audio>

``` bash
$ Auf das was jetzt kommt habe ich nämlich absolut keinen Bock
$ Auf das was jetzt kommt habe ich nämlich absolut keinen Bock
```

**[DE_05]**

<audio controls>
  <source src="/others/de_5.wav" type="audio/wav">
</audio>

``` bash
$ Ich könnte eine Mitfahrgelegenheit nach Schweinfurt anbieten
$ Ich könnte eine Mitfahrgelegenheit nach Schweinfurt anbieten
```

**[DE_06]**

<audio controls>
  <source src="/others/de_6.wav" type="audio/wav">
</audio>

``` bash
$ Man sollte den Länderfinanzausgleich durch einen Bundesligasoli ersetzen
$ Man sollte den Länderfinanzausgleich durch ein Bundesliga Soli ersetzen
```

**[DE_07]**

<audio controls>
  <source src="/others/de_7.wav" type="audio/wav">
</audio>

``` bash
$ Von Salzburg ist es doch nicht weit bis zum Chiemsee
$ Von Salzburg ist es doch nicht weit Bistum Chiemsee
```

**[DE_08]**

<audio controls>
  <source src="/others/de_8.wav" type="audio/wav">
</audio>

``` bash
$ Selbst für den erfahrensten Chirurgen ist der Tumor eine knifflige Herausforderung
$ Selbst für den erfahrensten Chirurgen ist der Tumor eine knifflige raus Federung
```

**[DE_09]**

<audio controls>
  <source src="/others/de_9.wav" type="audio/wav">
</audio>

``` bash
$ Folgende Lektüre kann ich ihnen zum Thema Kognitionspsychologie empfehlen
$ Folgende Lektüre kann ich ihn zum Thema Kognitionspsychologie empfehlen
``` 

**[DE_10]**

<audio controls>
  <source src="/others/de_10.wav" type="audio/wav">
</audio>

``` bash
$ Warum werden da keine strafrechtlichen Konsequenzen gezogen
$ Warum werden da keine strafrechtlichen Konsequenzen gezogen
```

### CASE HPC

One of the important task was to run the model on CASE HPC using Singularity. This was almost as challenging as training the model. Singularity is based on the same concept of Docker but it doesn't provide **root**. The below image helped me to understand Singularity.

![](
/others/singularity.png)

Singularity provides an environment to hold all the dependencies. I created a Singularity file at GitHub, that gets automatically build at Singularity Hub. The image can be pulled from Singularity Hub and 




This is a small excerpt from the Red Hen News Dataset. The MP4 files are programmatically converted to WAV and fed to Kaldi-Gstreamer-Server. The model output, i.e., the transcripts are further formatted to adopt [Red Hen's Data Format](https://sites.google.com/site/distributedlittleredhen/home/the-cognitive-core-research-topics-in-red-hen/red-hen-data-format#TOC-Audio-Pipeline-Tags).
	
``` bash	
TOP|20190812180001|2019-08-12_1800_DE_DasErste_Tagesschau
COL|Communication Studies Archive, UCLA
UID|3ef55370-bd2d-11e9-95d1-b78b1645001f
DUR|00:14:54
VID|720x576|640x512
SRC|Osnabruck, Germany
CMT|Evening news
CC1|DEU 150
ASR_01|DE
20190812180010.000|20190812180013.760|CC1|Hier ist das Erste Deutsche Fernsehen mit der tagesschau.
ASR_01|2019-08-15 08:34|Source_Program=Kaldi,infer.sh|Source_Person=Aashish Agarwal|Codebook=Deutsch Speech to Text
20190812180014.280|20190812180024.280|ASR_01|So ist es die erste deutsche Fernsehen mit der Tagesschau. Heute im Studio Jan Hofer Nama der Damen und Herren ich begrüße sie zwei Tage. Bundesumweltministerin Schultze will die Hersteller von wegwerfen Artikeln künftig an den Kosten für die Müllbeseitigung beteiligen die es für die Politiker werden stellt ihre Pläne heute in Berlin vor Die sprach von einer regelrechten Müll Flut in manchen Städten Ziel sei eine finanzielle Entlastung der Kommunen und ein Umdenken in der Gesellschaft betroffen werden. <UNK> anderem Firmen sein die Verpackungen Getränke Becher Plastiktüten und Zigaretten Filter produzieren. Alltag auf deutschen Straßen. Reste der wegwerfen Gesellschaft. Für die Aufräumarbeiten Zahlen Städte und Gemeinden. Die Bundesumweltministerin will die Kommunen entlasten mit Geld das sie bei den Herstellern der wegwerfen Artikel eintreiben möchte. Heißt das Sie müssen für das Einsammeln dieser Produkte zahlen sie müssen sich anteilsmäßig an den Kosten für das Aufstellen von Abfall Behältern Beteiligungen ebenso müssen sich diese Hersteller an den Kosten für die Entsorgung beziehungsweise das Recycling beteiligen damit setzt wenn ihr Schulz für eine EU Richtlinie. Der Koalitionspartner aber sorgt das ginge auch anders ohne eine Zusatzbelastungen der Verpackungsindustrie
END|20190812181455|2019-08-12_1800_DE_DasErste_Tagesschau
```

Next week is the last week. I will documenting all my work. Hope you enjoyed reading my blogs!!

### Others

- [My GSoC 2019 Journey](https://aashishag.github.io/categories/#gsoc)
- [Repository of Code](https://github.com/AASHISHAG/asr-german)